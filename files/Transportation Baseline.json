{"name":"Transportation Baseline","description":"","version":"1.0","culture":"en-US","modifiedTime":"2024-07-08T19:40:58.8085534+00:00","ppdf:outputFileFormat":"csv","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"skipAutomaticHeaderAndTypeDetection":false,"queriesMetadata":{"Transportation Baseline":{"queryId":"6f436e91-060d-4413-9b80-e50ecbfb1143","queryName":"Transportation Baseline","queryGroupId":"125bacaf-182f-411a-b35a-d730e8444bcd","loadEnabled":true},"Service Category":{"queryId":"0da6d412-06b0-4186-ae35-c3a577137e83","queryName":"Service Category","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"Location":{"queryId":"0e5a918b-76b3-4655-a449-6ebe0e90b332","queryName":"Location","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"Transportation_load":{"queryId":"0b82ca85-41c6-4ce0-be0a-362b6429707b","queryName":"Transportation_load","queryGroupId":"2c9b9a1f-38ad-4936-9aeb-1945744288ea"},"FilePath":{"queryId":"62ec6c18-5472-41da-9e1a-494ee2a58176","queryName":"FilePath","queryGroupId":"1f38bce3-7902-422e-953f-17208d7e4cd6"},"FileName":{"queryId":"58fea221-d7ba-42f7-9424-e278b68d6403","queryName":"FileName","queryGroupId":"1f38bce3-7902-422e-953f-17208d7e4cd6"},"FileName2":{"queryId":"13c01e65-345b-470f-9091-a4cebf8e51bd","queryName":"FileName2","queryGroupId":"1f38bce3-7902-422e-953f-17208d7e4cd6"},"Transportation2_load":{"queryId":"ed67ad72-b8b1-4354-a86e-c4a7d291b1d2","queryName":"Transportation2_load","queryGroupId":"2c9b9a1f-38ad-4936-9aeb-1945744288ea"},"Trailer Status":{"queryId":"7487d405-0822-4296-90fa-b644d873723b","queryName":"Trailer Status","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"Road Status":{"queryId":"32479e55-0853-4cc6-8202-15ca18306427","queryName":"Road Status","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"Trip Status":{"queryId":"1fcea3b7-71b3-47f2-aa75-0787d57b2dbf","queryName":"Trip Status","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"Invoice Status":{"queryId":"0b641498-c2ce-4958-828a-b6fcd0a028d1","queryName":"Invoice Status","queryGroupId":"ff1a999a-efe9-499c-b2cd-6d7e952878ec"},"UTC_DateTimeZone":{"queryId":"d2168219-24a1-4f94-a9fb-041d5876c875","queryName":"UTC_DateTimeZone","queryGroupId":"23e51376-71cb-4a0a-a5b2-998901847d60","loadEnabled":true}},"document":"section Section1;\r\nshared #\"Transportation Baseline\" = let\n  Source = Transportation2_load,\n  // Promote headers from the source data\n  PromotedHeaders = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  // Add an index column named \"No_Guia\"\n  AddedIndex = Table.AddIndexColumn(PromotedHeaders, \"No_Guia\", 1, 1, Int64.Type),\n  // Reorder columns with No Guia at the beginning\n  ReorderColumns = Table.ReorderColumns(AddedIndex, {\"No_Guia\", \"Trip_id\", \"Departure_date\", \"Driver_id\", \"Trailer_id\", \"Customer_id\", \"Origin_location\", \"Destination_location\", \"Km_travelled\", \"Diesel_expenses\", \"Trailer_status\", \"Service_category\", \"Road_status\", \"Trip_status\", \"Invoice_status\", \"Invoice_number\", \"Income_per_km\", \"Arrival_date\"}),\n  // Change column types\n  ChangedColumnType = Table.TransformColumnTypes(ReorderColumns, {{\"Km_travelled\", Int64.Type}, {\"Income_per_km\", type number}, {\"Diesel_expenses\", type number}}),\n  // Calculate the amount based on KmTravelled and IncomePerKm\n  InsertedMultiplication = Table.AddColumn(ChangedColumnType, \"Amount\", each [Km_travelled] * [Income_per_km], type number),\n  // Merge queries for service category\n  MergedQueries1 = Table.NestedJoin(InsertedMultiplication, {\"Service_category\"}, #\"Service Category\", {\"Service_category\"}, \"Service Category\", JoinKind.LeftOuter),\n  // Expand service category table\n  ExpandedServiceCategory = Table.ExpandTableColumn(MergedQueries1, \"Service Category\", {\"Category_Id\"}, {\"Category_Id\"}),\n  // Merge queries for origin location\n  MergedQueries2 = Table.NestedJoin(ExpandedServiceCategory, {\"Origin_location\"}, Location, {\"Location\"}, \"Location\", JoinKind.LeftOuter),\n  // Expand origin location table\n  ExpandedOriginLocation = Table.ExpandTableColumn(MergedQueries2, \"Location\", {\"Location_Id\"}, {\"Origin_Id\"}),\n  // Merge queries for destination location\n  MergedQueries3 = Table.NestedJoin(ExpandedOriginLocation, {\"Destination_location\"}, Location, {\"Location\"}, \"Location\", JoinKind.LeftOuter),\n  // Expand destination location table\n  ExpandedDestinationLocation = Table.ExpandTableColumn(MergedQueries3, \"Location\", {\"Location_Id\"}, {\"Destination_Id\"}),\n  // Merge queries for trailer status\n  MergeQueriesTrailerStatus = Table.NestedJoin(ExpandedDestinationLocation, {\"Trailer_status\"}, #\"Trailer Status\", {\"Trailer_status\"}, \"Trailer Status\", JoinKind.LeftOuter),\n  // Expand trailer status table\n  ExpandTrailerStatus = Table.ExpandTableColumn(MergeQueriesTrailerStatus, \"Trailer Status\", {\"TrailerStatus_Id\"}, {\"TrailerStatus_Id\"}),\n  // Merge queries for trip status\n  MergeQueriesTripStatus = Table.NestedJoin(ExpandTrailerStatus, {\"Trip_status\"}, #\"Trip Status\", {\"Trip_status\"}, \"Trip Status\", JoinKind.LeftOuter),\n  // Expand trip status table\n  ExpandTripStatus = Table.ExpandTableColumn(MergeQueriesTripStatus, \"Trip Status\", {\"TripStatus_Id\"}, {\"TripStatus_Id\"}),\n  // Merge queries for road status\n  MergeQueriesRoadStatus = Table.NestedJoin(ExpandTripStatus, {\"Road_status\"}, #\"Road Status\", {\"Road_status\"}, \"Road Status\", JoinKind.LeftOuter),\n  // Expand road status table\n  ExpandRoadStatus = Table.ExpandTableColumn(MergeQueriesRoadStatus, \"Road Status\", {\"RoadStatus_Id\"}, {\"RoadStatus_Id\"}),\n  // Merge queries for invoice status\n  MergeQueriesInvoiceStatus = Table.NestedJoin(ExpandRoadStatus, {\"Invoice_status\"}, #\"Invoice Status\", {\"Invoice_status\"}, \"Invoice Status\", JoinKind.LeftOuter),\n  // Expand invoice status\n  ExpandInvoiceStatus = Table.ExpandTableColumn(MergeQueriesInvoiceStatus, \"Invoice Status\", {\"InvoiceStatus_Id\"}, {\"InvoiceStatus_Id\"}),\n  // Calculate diesel expense based on $0.804672 USD/Km\n  InsertDieselExpense = Table.AddColumn(ExpandInvoiceStatus, \"Diesel_expense\", each [Km_travelled] * 0.804672, Int64.Type),\n  // Choose columns\n  ChooseColumns = Table.SelectColumns(InsertDieselExpense, {\"No_Guia\", \"Trip_id\", \"Departure_date\", \"Driver_id\", \"Trailer_id\", \"Customer_id\", \"Km_travelled\", \"Invoice_number\", \"Arrival_date\", \"Amount\", \"Category_Id\", \"Origin_Id\", \"Destination_Id\", \"TrailerStatus_Id\", \"TripStatus_Id\", \"RoadStatus_Id\", \"InvoiceStatus_Id\", \"Diesel_expense\"}),\n  // Change column types\n  ChangeColumnType = Table.TransformColumnTypes(ChooseColumns, {{\"No_Guia\", Int64.Type}, {\"Trip_id\", Int64.Type}, {\"Departure_date\", type date}, {\"Driver_id\", Int64.Type}, {\"Trailer_id\", Int64.Type}, {\"Customer_id\", Int64.Type}, {\"Km_travelled\", Int64.Type}, {\"Invoice_number\", Int64.Type}, {\"Arrival_date\", type date}, {\"Amount\", type number}, {\"Category_Id\", Int64.Type}, {\"Origin_Id\", Int64.Type}, {\"Destination_Id\", Int64.Type}, {\"TrailerStatus_Id\", Int64.Type}, {\"TripStatus_Id\", Int64.Type}, {\"RoadStatus_Id\", Int64.Type}, {\"InvoiceStatus_Id\", Int64.Type}, {\"Diesel_expense\", type number}})\nin\n  ChangeColumnType;\r\nshared #\"Service Category\" = let\n  Source = Transportation2_load,\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Removed other columns\" = Table.SelectColumns(#\"Promoted headers\", {\"Service_category\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed other columns\", {\"Service_category\"}),\n  #\"Added index\" = Table.AddIndexColumn(#\"Removed duplicates\", \"Category_Id\", 1, 1, Int64.Type),\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Added index\", {\"Category_Id\", \"Service_category\"})\nin\n  #\"Reordered columns\";\r\nshared Location = let\n  Source = Transportation2_load,\n  PromoteHeaders = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  RemoveOtherColumns = Table.SelectColumns(PromoteHeaders, {\"Origin_location\", \"Destination_location\"}),\n  ConvertToList_Destination = RemoveOtherColumns[Destination_location],\n  ConvertToList_Origin = RemoveOtherColumns[Origin_location],\n  OriginAndDestinationList= List.Combine({{ConvertToList_Origin}, {ConvertToList_Destination}}),\n  ConvertToTable = Table.FromList(OriginAndDestinationList, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n  ExpandColumn1 = Table.ExpandListColumn(ConvertToTable, \"Column1\"),\n  RenameColumnLocation = Table.RenameColumns(ExpandColumn1, {{\"Column1\", \"Location\"}}),\n  ChangeColumnType2 = Table.TransformColumnTypes(RenameColumnLocation, {{\"Location\", type text}}),\n  RemoveDuplicates = Table.Distinct(ChangeColumnType2, {\"Location\"}),\n  AddLocationID = Table.AddIndexColumn(RemoveDuplicates, \"Location_Id\", 1, 1, Int64.Type),\n  ReorderColumns = Table.ReorderColumns(AddLocationID, {\"Location_Id\", \"Location\"})\nin\n  ReorderColumns;\r\nshared Transportation_load = let\n  Source = Csv.Document(Web.Contents(FilePath & FileName), [Delimiter = \",\", Columns = 12, QuoteStyle = QuoteStyle.None])\nin\n  Source;\r\nshared FilePath = \"https://altasymposium-my.sharepoint.com/personal/fernando_calero_altasymposium_onmicrosoft_com/Documents/BI/Samples/Freight and Transport/\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type text];\r\nshared FileName = \"df_clean.csv\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type text];\r\nshared FileName2 = \"trips_df.csv\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type text];\r\nshared Transportation2_load = let\n  Source = Csv.Document(Web.Contents(FilePath & FileName2), [Delimiter = \",\", Columns = 17, QuoteStyle = QuoteStyle.None])\nin\n  Source;\r\nshared #\"Trailer Status\" = let\n  Source = Transportation2_load,\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Removed other columns\" = Table.SelectColumns(#\"Promoted headers\", {\"Trailer_status\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed other columns\", {\"Trailer_status\"}),\n  #\"Added index\" = Table.AddIndexColumn(#\"Removed duplicates\", \"TrailerStatus_Id\", 1, 1, Int64.Type),\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Added index\", {\"TrailerStatus_Id\", \"Trailer_status\"})\nin\n  #\"Reordered columns\";\r\nshared #\"Road Status\" = let\n  Source = Transportation2_load,\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Removed other columns\" = Table.SelectColumns(#\"Promoted headers\", {\"Road_status\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed other columns\", {\"Road_status\"}),\n  #\"Added index\" = Table.AddIndexColumn(#\"Removed duplicates\", \"RoadStatus_Id\", 1, 1, Int64.Type),\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Added index\", {\"RoadStatus_Id\", \"Road_status\"})\nin\n  #\"Reordered columns\";\r\nshared #\"Trip Status\" = let\n  Source = Transportation2_load,\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Removed other columns\" = Table.SelectColumns(#\"Promoted headers\", {\"Trip_status\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed other columns\", {\"Trip_status\"}),\n  #\"Added index\" = Table.AddIndexColumn(#\"Removed duplicates\", \"TripStatus_Id\", 1, 1, Int64.Type),\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Added index\", {\"TripStatus_Id\", \"Trip_status\"})\nin\n  #\"Reordered columns\";\r\nshared #\"Invoice Status\" = let\n  Source = Transportation2_load,\n  #\"Promoted headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars = true]),\n  #\"Removed other columns\" = Table.SelectColumns(#\"Promoted headers\", {\"Invoice_status\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed other columns\", {\"Invoice_status\"}),\n  #\"Added index\" = Table.AddIndexColumn(#\"Removed duplicates\", \"InvoiceStatus_Id\", 1, 1, Int64.Type),\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Added index\", {\"InvoiceStatus_Id\", \"Invoice_status\"})\nin\n  #\"Reordered columns\";\r\nshared UTC_DateTimeZone = let \n  UTC_DateTimeZone = DateTimeZone.UtcNow(),\n  Offset = DateTimeZone.SwitchZone( UTC_DateTimeZone, -6 ),\n  ConvertToTable = #table(1, {{Offset}}),\n  RenameColumns = Table.RenameColumns(ConvertToTable, {{\"Column1\", \"LastRefresh\"}}),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(RenameColumns, {{\"LastRefresh\", type datetimezone}})\nin\n  #\"Changed column type\";\r\n","connectionOverrides":[{"path":"https://altasymposium-my.sharepoint.com/personal/fernando_calero_altasymposium_onmicrosoft_com","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://altasymposium-my.sharepoint.com/personal/fernando_calero_altasymposium_onmicrosoft_com\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"id\":\"2c9b9a1f-38ad-4936-9aeb-1945744288ea\",\"name\":\"Load\",\"description\":\"\",\"parentId\":null,\"order\":0},{\"id\":\"ff1a999a-efe9-499c-b2cd-6d7e952878ec\",\"name\":\"Dim\",\"description\":\"\",\"parentId\":null,\"order\":1},{\"id\":\"125bacaf-182f-411a-b35a-d730e8444bcd\",\"name\":\"Fact\",\"description\":\"\",\"parentId\":null,\"order\":2},{\"id\":\"1f38bce3-7902-422e-953f-17208d7e4cd6\",\"name\":\"Parameters\",\"description\":\"\",\"parentId\":null,\"order\":3},{\"id\":\"23e51376-71cb-4a0a-a5b2-998901847d60\",\"name\":\"Refresh\",\"description\":\"\",\"parentId\":null,\"order\":0}]"}],"entities":[{"$type":"LocalEntity","name":"Transportation Baseline","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Transportation%20Baseline.csv"},"attributes":[{"name":"No_Guia","dataType":"int64"},{"name":"Trip_id","dataType":"int64"},{"name":"Departure_date","dataType":"date"},{"name":"Driver_id","dataType":"int64"},{"name":"Trailer_id","dataType":"int64"},{"name":"Customer_id","dataType":"int64"},{"name":"Km_travelled","dataType":"int64"},{"name":"Invoice_number","dataType":"int64"},{"name":"Arrival_date","dataType":"date"},{"name":"Amount","dataType":"double"},{"name":"Category_Id","dataType":"int64"},{"name":"Origin_Id","dataType":"int64"},{"name":"Destination_Id","dataType":"int64"},{"name":"TrailerStatus_Id","dataType":"int64"},{"name":"TripStatus_Id","dataType":"int64"},{"name":"RoadStatus_Id","dataType":"int64"},{"name":"InvoiceStatus_Id","dataType":"int64"},{"name":"Diesel_expense","dataType":"double"}],"partitions":[{"name":"Part001","refreshTime":"2024-07-08T19:42:32.9992375+00:00","location":"https://wabipaas1scuscdsa.blob.core.windows.net:443/17c75174-1aac-4d53-9fd0-731bbb62b0a3/Transportation%2520Baseline.csv?snapshot=2024-07-08T19%3A42%3A33.0054314Z"}]},{"$type":"LocalEntity","name":"UTC_DateTimeZone","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"UTC_DateTimeZone.csv"},"attributes":[{"name":"LastRefresh","dataType":"dateTimeOffset"}],"partitions":[{"name":"Part001","refreshTime":"2024-07-08T19:43:03.3594898+00:00","location":"https://wabipaas1scuscdsa.blob.core.windows.net:443/17c75174-1aac-4d53-9fd0-731bbb62b0a3/UTC_DateTimeZone.csv?snapshot=2024-07-08T19%3A43%3A03.3651326Z"}]}]}